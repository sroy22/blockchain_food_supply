{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\MscAC\\\\Blockchain\\\\2125\\\\Code\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\MscAC\\\\Blockchain\\\\2125\\\\Code\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\MscAC\\\\Blockchain\\\\2125\\\\Code\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\MscAC\\\\Blockchain\\\\2125\\\\Code\\\\src\\\\Weather.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport Web3 from 'web3';\nimport Investment from './abis/Investment.json';\nimport Marketplace from './abis/Marketplace.json';\n\nfunction Weather(props) {\n  var _this = this;\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      account = _useState2[0],\n      setAccount = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      investment = _useState4[0],\n      setInvestment = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      marketplace = _useState6[0],\n      setMarketplace = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      farmerCount = _useState8[0],\n      setFarmerCount = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      farmers = _useState10[0],\n      setFarmers = _useState10[1];\n\n  var _useState11 = useState(0),\n      _useState12 = _slicedToArray(_useState11, 2),\n      productCount = _useState12[0],\n      setProductCount = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      products = _useState14[0],\n      setProducts = _useState14[1];\n\n  var _useState15 = useState(0),\n      _useState16 = _slicedToArray(_useState15, 2),\n      pro = _useState16[0],\n      setPro = _useState16[1];\n\n  var _useState17 = useState(0),\n      _useState18 = _slicedToArray(_useState17, 2),\n      initial = _useState18[0],\n      setInitial = _useState18[1];\n\n  var _useState19 = useState(0),\n      _useState20 = _slicedToArray(_useState19, 2),\n      investorCount = _useState20[0],\n      SetInvestorCount = _useState20[1];\n\n  var _useState21 = useState(''),\n      _useState22 = _slicedToArray(_useState21, 2),\n      farmerName = _useState22[0],\n      setFarmerName = _useState22[1];\n\n  var _useState23 = useState(0),\n      _useState24 = _slicedToArray(_useState23, 2),\n      premium = _useState24[0],\n      setPremium = _useState24[1];\n\n  var _useState25 = useState(''),\n      _useState26 = _slicedToArray(_useState25, 2),\n      type = _useState26[0],\n      setType = _useState26[1];\n\n  var textInput = useRef(null);\n\n  function loadWeb3() {\n    return _loadWeb.apply(this, arguments);\n  }\n\n  function _loadWeb() {\n    _loadWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!window.ethereum) {\n                _context3.next = 6;\n                break;\n              }\n\n              window.web3 = new Web3(window.ethereum);\n              _context3.next = 4;\n              return window.ethereum.enable();\n\n            case 4:\n              _context3.next = 7;\n              break;\n\n            case 6:\n              if (window.web3) {\n                window.web3 = new Web3(window.web3.currentProvider);\n              } else {\n                window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n              }\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return _loadWeb.apply(this, arguments);\n  }\n\n  function loadBlockchainData() {\n    return _loadBlockchainData.apply(this, arguments);\n  }\n\n  function _loadBlockchainData() {\n    _loadBlockchainData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var web3, accounts, networkId, networkData, place, count, dealcount, p, deals, c, i, farmer, deal, networkDataMarketplace, _place, _count, _p, _deals, _c, _farmer;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              web3 = window.web3; // Load account\n\n              _context4.next = 3;\n              return web3.eth.getAccounts();\n\n            case 3:\n              accounts = _context4.sent;\n              setInitial(accounts[0]);\n              setAccount(accounts[0]); //this.setState({ account: accounts[0] })\n\n              _context4.next = 8;\n              return web3.eth.net.getId();\n\n            case 8:\n              networkId = _context4.sent;\n              networkData = Investment.networks[networkId];\n\n              if (!networkData) {\n                _context4.next = 44;\n                break;\n              }\n\n              place = new web3.eth.Contract(Investment.abi, networkData.address);\n              setInvestment(place);\n              _context4.next = 15;\n              return place.methods.farmerCount().call();\n\n            case 15:\n              count = _context4.sent;\n              setFarmerCount(count); // Load products\n\n              _context4.next = 19;\n              return place.methods.dealCount().call();\n\n            case 19:\n              dealcount = _context4.sent;\n              SetInvestorCount(dealcount);\n              p = [];\n              deals = [];\n              i = 1;\n\n            case 24:\n              if (!(i <= count)) {\n                _context4.next = 32;\n                break;\n              }\n\n              _context4.next = 27;\n              return place.methods.farmers(i).call();\n\n            case 27:\n              farmer = _context4.sent;\n              p.push(farmer);\n\n            case 29:\n              i++;\n              _context4.next = 24;\n              break;\n\n            case 32:\n              i = 1;\n\n            case 33:\n              if (!(i <= dealcount)) {\n                _context4.next = 41;\n                break;\n              }\n\n              _context4.next = 36;\n              return place.methods.deals(i).call();\n\n            case 36:\n              deal = _context4.sent;\n              deals.push(deal);\n\n            case 38:\n              i++;\n              _context4.next = 33;\n              break;\n\n            case 41:\n              setFarmers(p);\n              _context4.next = 45;\n              break;\n\n            case 44:\n              window.alert('Marketplace contract not deployed to detected network.');\n\n            case 45:\n              networkDataMarketplace = Marketplace.networks[networkId];\n\n              if (!networkDataMarketplace) {\n                _context4.next = 68;\n                break;\n              }\n\n              _place = new web3.eth.Contract(Marketplace.abi, networkDataMarketplace.address);\n              setMarketplace(_place);\n              _context4.next = 51;\n              return _place.methods.productCount().call();\n\n            case 51:\n              _count = _context4.sent;\n              console.log(_count);\n              setProductCount(_count); // Load products\n\n              _p = [];\n              _deals = [];\n              i = 1;\n\n            case 57:\n              if (!(i <= _count)) {\n                _context4.next = 65;\n                break;\n              }\n\n              _context4.next = 60;\n              return _place.methods.products(i).call();\n\n            case 60:\n              _farmer = _context4.sent;\n\n              _p.push(_farmer);\n\n            case 62:\n              i++;\n              _context4.next = 57;\n              break;\n\n            case 65:\n              setProducts(_p);\n              _context4.next = 69;\n              break;\n\n            case 68:\n              window.alert('Marketplace contract not deployed to detected network.');\n\n            case 69:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n    return _loadBlockchainData.apply(this, arguments);\n  }\n\n  function createInsurance(_x, _x2) {\n    return _createInsurance.apply(this, arguments);\n  }\n\n  function _createInsurance() {\n    _createInsurance = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(name, price) {\n      var delayInMilliseconds;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              console.log(initial);\n              console.log(\"Hhsjdhfskj\");\n              marketplace.methods.createProduct(name, price, initial).send({\n                from: account,\n                value: price\n              }).on('transactionHash', function (hash) {\n                setPro(1);\n              });\n              delayInMilliseconds = 8000; //1 second\n\n              setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n                return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                  while (1) {\n                    switch (_context5.prev = _context5.next) {\n                      case 0:\n                        //your code to be executed after 1 second\n                        loadBlockchainData();\n\n                      case 1:\n                      case \"end\":\n                        return _context5.stop();\n                    }\n                  }\n                }, _callee5);\n              })), delayInMilliseconds); // let tx = await marketplace.methods.createProduct(name, price).send({ from: account })\n              // tx.wait().then({\n              //   loadBlockchainData\n              // })\n\n            case 5:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n    return _createInsurance.apply(this, arguments);\n  }\n\n  function reimburse(id, price) {\n    console.log(price);\n    console.log(id);\n    console.log(initial);\n    console.log(account);\n    marketplace.methods.purchaseProduct(id).send({\n      from: account,\n      value: price,\n      to: initial\n    }).once('receipt', function (receipt) {//      this.setState({ loading: false })\n    });\n    var delayInMilliseconds = 8000; //1 second\n\n    setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              //your code to be executed after 1 second\n              loadBlockchainData();\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })), delayInMilliseconds);\n  }\n\n  window.ethereum.on('accountsChanged', function (accounts) {\n    // Time to reload your interface with accounts[0]!\n    console.log(accounts);\n    setAccount(accounts[0]);\n  });\n\n  function createProduct(_x3, _x4, _x5, _x6, _x7, _x8, _x9) {\n    return _createProduct.apply(this, arguments);\n  }\n\n  function _createProduct() {\n    _createProduct = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(name, location, crop, quantity, price, expiryDate, holding) {\n      var delayInMilliseconds;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              investment.methods.createFarmer(name, location, crop, quantity, price, expiryDate, holding).send({\n                from: account\n              });\n              delayInMilliseconds = 8000; //1 second\n\n              setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n                return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                  while (1) {\n                    switch (_context7.prev = _context7.next) {\n                      case 0:\n                        //your code to be executed after 1 second\n                        loadBlockchainData();\n\n                      case 1:\n                      case \"end\":\n                        return _context7.stop();\n                    }\n                  }\n                }, _callee7);\n              })), delayInMilliseconds);\n\n            case 3:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n    return _createProduct.apply(this, arguments);\n  }\n\n  function payBackToInvestor(_x10) {\n    return _payBackToInvestor.apply(this, arguments);\n  }\n\n  function _payBackToInvestor() {\n    _payBackToInvestor = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(event) {\n      var deals, i, deal;\n      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              deals = [];\n              i = 1;\n\n            case 2:\n              if (!(i <= investorCount)) {\n                _context9.next = 12;\n                break;\n              }\n\n              _context9.next = 5;\n              return investment.methods.deals(i).call();\n\n            case 5:\n              deal = _context9.sent;\n              deal.amount = deal.amount + \"000000000000000000\";\n              investment.methods.repay(deal.farmerID).send({\n                from: account,\n                value: deal.amount,\n                to: deal.investorAddress\n              });\n              deals.push(deal);\n\n            case 9:\n              i++;\n              _context9.next = 2;\n              break;\n\n            case 12:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }));\n    return _payBackToInvestor.apply(this, arguments);\n  }\n\n  function purchaseProduct(id, price, amount, holdingPercent) {\n    investment.methods.purchaseProduct(id).send({\n      from: account,\n      value: price,\n      to: initial\n    });\n    investment.methods.createAgreement(id, amount, holdingPercent).send({\n      from: account\n    }).on('transactionHash', function (hash) {\n      setPro(1);\n    });\n    var delayInMilliseconds = 8000; //1 second\n\n    setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              //your code to be executed after 1 second\n              loadBlockchainData();\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    })), delayInMilliseconds);\n  }\n\n  window.ethereum.on('accountsChanged', function (accounts) {\n    // Time to reload your interface with accounts[0]!\n    setAccount(accounts[0]);\n  }); // Similar to componentDidMount and componentDidUpdate:\n\n  useEffect(function () {\n    loadWeb3();\n    loadBlockchainData(); // Update the document title using the browser API\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }, \" \", initial), /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 9\n    }\n  }, \"Buy Insurance\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: function onSubmit(event) {\n      console.log(premium);\n      console.log(textInput.current.value);\n      console.log(farmerName);\n      console.log(event.target.farmerName);\n      event.preventDefault();\n      var premiumVal = window.web3.utils.toWei(premium.toString(), 'Ether');\n\n      _this.props.createInsurance(farmerName, premiumVal, type);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group mr-sm-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    id: \"farmerName\",\n    type: \"text\",\n    ref: textInput,\n    className: \"form-control\",\n    placeholder: \"Famer Name\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group mr-sm-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    id: \"premium\",\n    type: \"text\",\n    ref: function ref(input) {\n      setPremium(input);\n    },\n    className: \"form-control\",\n    placeholder: \"Premium\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group mr-sm-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    id: \"type\",\n    type: \"text\",\n    ref: function ref(input) {\n      setType(input);\n    },\n    className: \"form-control\",\n    placeholder: \"type\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 11\n    }\n  }, \"Add Farmer Details\")), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 9\n    }\n  }, \"\\xA0\"), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }\n  }, \"Farmer Payouts\"), /*#__PURE__*/React.createElement(\"table\", {\n    className: \"table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 15\n    }\n  }, \"#\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 15\n    }\n  }, \"Name\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 15\n    }\n  }, \"Premium\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 15\n    }\n  }, \"Type\"), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"tbody\", {\n    id: \"productList\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 11\n    }\n  }, products.map(function (product, key) {\n    console.log(product);\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      key: key,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      scope: \"row\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 19\n      }\n    }, product.farmerId), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 19\n      }\n    }, product.name), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 19\n      }\n    }, product.type), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 19\n      }\n    }, window.web3.utils.fromWei(product.price.toString(), 'Ether'), \" Eth\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 19\n      }\n    }, !product.purchased ? /*#__PURE__*/React.createElement(\"button\", {\n      name: product.id,\n      value: product.price,\n      onClick: function onClick(event) {\n        _this.props.reimburse(event.target.name, event.target.value);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 25\n      }\n    }, \"Reimburse\") : null));\n  }))));\n}\n\nexport default Weather;","map":{"version":3,"sources":["C:/MscAC/Blockchain/2125/Code/src/Weather.js"],"names":["React","useState","useEffect","useRef","Web3","Investment","Marketplace","Weather","props","account","setAccount","investment","setInvestment","marketplace","setMarketplace","farmerCount","setFarmerCount","farmers","setFarmers","productCount","setProductCount","products","setProducts","pro","setPro","initial","setInitial","investorCount","SetInvestorCount","farmerName","setFarmerName","premium","setPremium","type","setType","textInput","loadWeb3","window","ethereum","web3","enable","currentProvider","alert","loadBlockchainData","eth","getAccounts","accounts","net","getId","networkId","networkData","networks","place","Contract","abi","address","methods","call","count","dealCount","dealcount","p","deals","i","farmer","push","deal","networkDataMarketplace","console","log","createInsurance","name","price","createProduct","send","from","value","on","hash","delayInMilliseconds","setTimeout","reimburse","id","purchaseProduct","to","once","receipt","location","crop","quantity","expiryDate","holding","createFarmer","payBackToInvestor","event","amount","repay","farmerID","investorAddress","holdingPercent","createAgreement","current","target","preventDefault","premiumVal","utils","toWei","toString","input","map","product","key","farmerId","fromWei","purchased"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,MAArC,QAAmD,OAAnD;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,UAAP,MAAuB,wBAAvB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;;AAEA,SAASC,OAAT,CAAkBC,KAAlB,EAAyB;AAAA;;AAAA,kBAEOP,QAAQ,CAAC,CAAD,CAFf;AAAA;AAAA,MAEhBQ,OAFgB;AAAA,MAEPC,UAFO;;AAAA,mBAGaT,QAAQ,CAAC,IAAD,CAHrB;AAAA;AAAA,MAGhBU,UAHgB;AAAA,MAGJC,aAHI;;AAAA,mBAIeX,QAAQ,CAAC,IAAD,CAJvB;AAAA;AAAA,MAIhBY,WAJgB;AAAA,MAIHC,cAJG;;AAAA,mBAMeb,QAAQ,CAAC,CAAD,CANvB;AAAA;AAAA,MAMhBc,WANgB;AAAA,MAMHC,cANG;;AAAA,mBAOOf,QAAQ,CAAC,EAAD,CAPf;AAAA;AAAA,MAOhBgB,OAPgB;AAAA,MAOPC,UAPO;;AAAA,oBASiBjB,QAAQ,CAAC,CAAD,CATzB;AAAA;AAAA,MAShBkB,YATgB;AAAA,MASFC,eATE;;AAAA,oBAUSnB,QAAQ,CAAC,EAAD,CAVjB;AAAA;AAAA,MAUhBoB,QAVgB;AAAA,MAUNC,WAVM;;AAAA,oBAYDrB,QAAQ,CAAC,CAAD,CAZP;AAAA;AAAA,MAYhBsB,GAZgB;AAAA,MAYXC,MAZW;;AAAA,oBAaOvB,QAAQ,CAAC,CAAD,CAbf;AAAA;AAAA,MAahBwB,OAbgB;AAAA,MAaPC,UAbO;;AAAA,oBAcmBzB,QAAQ,CAAC,CAAD,CAd3B;AAAA;AAAA,MAchB0B,aAdgB;AAAA,MAcDC,gBAdC;;AAAA,oBAgBa3B,QAAQ,CAAC,EAAD,CAhBrB;AAAA;AAAA,MAgBhB4B,UAhBgB;AAAA,MAgBJC,aAhBI;;AAAA,oBAiBO7B,QAAQ,CAAC,CAAD,CAjBf;AAAA;AAAA,MAiBhB8B,OAjBgB;AAAA,MAiBPC,UAjBO;;AAAA,oBAkBC/B,QAAQ,CAAC,EAAD,CAlBT;AAAA;AAAA,MAkBhBgC,IAlBgB;AAAA,MAkBVC,OAlBU;;AAoBvB,MAAMC,SAAS,GAAGhC,MAAM,CAAC,IAAD,CAAxB;;AApBuB,WAuBRiC,QAvBQ;AAAA;AAAA;;AAAA;AAAA,wEAuBvB;AAAA;AAAA;AAAA;AAAA;AAAA,mBACMC,MAAM,CAACC,QADb;AAAA;AAAA;AAAA;;AAEID,cAAAA,MAAM,CAACE,IAAP,GAAc,IAAInC,IAAJ,CAASiC,MAAM,CAACC,QAAhB,CAAd;AAFJ;AAAA,qBAGUD,MAAM,CAACC,QAAP,CAAgBE,MAAhB,EAHV;;AAAA;AAAA;AAAA;;AAAA;AAKO,kBAAIH,MAAM,CAACE,IAAX,EAAiB;AACpBF,gBAAAA,MAAM,CAACE,IAAP,GAAc,IAAInC,IAAJ,CAASiC,MAAM,CAACE,IAAP,CAAYE,eAArB,CAAd;AACD,eAFI,MAGA;AACHJ,gBAAAA,MAAM,CAACK,KAAP,CAAa,qEAAb;AACD;;AAVH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAvBuB;AAAA;AAAA;;AAAA,WAmCRC,kBAnCQ;AAAA;AAAA;;AAAA;AAAA,mFAmCvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AACQJ,cAAAA,IADR,GACeF,MAAM,CAACE,IADtB,EAEE;;AAFF;AAAA,qBAGyBA,IAAI,CAACK,GAAL,CAASC,WAAT,EAHzB;;AAAA;AAGQC,cAAAA,QAHR;AAIEpB,cAAAA,UAAU,CAACoB,QAAQ,CAAC,CAAD,CAAT,CAAV;AACApC,cAAAA,UAAU,CAACoC,QAAQ,CAAC,CAAD,CAAT,CAAV,CALF,CAME;;AANF;AAAA,qBAO0BP,IAAI,CAACK,GAAL,CAASG,GAAT,CAAaC,KAAb,EAP1B;;AAAA;AAOQC,cAAAA,SAPR;AAQQC,cAAAA,WARR,GAQsB7C,UAAU,CAAC8C,QAAX,CAAoBF,SAApB,CARtB;;AAAA,mBASKC,WATL;AAAA;AAAA;AAAA;;AAUUE,cAAAA,KAVV,GAUkB,IAAIb,IAAI,CAACK,GAAL,CAASS,QAAb,CAAsBhD,UAAU,CAACiD,GAAjC,EAAsCJ,WAAW,CAACK,OAAlD,CAVlB;AAWI3C,cAAAA,aAAa,CAACwC,KAAD,CAAb;AAXJ;AAAA,qBAYwBA,KAAK,CAACI,OAAN,CAAczC,WAAd,GAA4B0C,IAA5B,EAZxB;;AAAA;AAYUC,cAAAA,KAZV;AAaI1C,cAAAA,cAAc,CAAC0C,KAAD,CAAd,CAbJ,CAcI;;AAdJ;AAAA,qBAgB4BN,KAAK,CAACI,OAAN,CAAcG,SAAd,GAA0BF,IAA1B,EAhB5B;;AAAA;AAgBUG,cAAAA,SAhBV;AAiBIhC,cAAAA,gBAAgB,CAACgC,SAAD,CAAhB;AACIC,cAAAA,CAlBR,GAkBY,EAlBZ;AAmBQC,cAAAA,KAnBR,GAmBgB,EAnBhB;AAqBaC,cAAAA,CArBb,GAqBiB,CArBjB;;AAAA;AAAA,oBAqBoBA,CAAC,IAAIL,KArBzB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAsB2BN,KAAK,CAACI,OAAN,CAAcvC,OAAd,CAAsB8C,CAAtB,EAAyBN,IAAzB,EAtB3B;;AAAA;AAsBYO,cAAAA,MAtBZ;AAuBMH,cAAAA,CAAC,CAACI,IAAF,CAAOD,MAAP;;AAvBN;AAqBgCD,cAAAA,CAAC,EArBjC;AAAA;AAAA;;AAAA;AAyBaA,cAAAA,CAzBb,GAyBiB,CAzBjB;;AAAA;AAAA,oBAyBoBA,CAAC,IAAIH,SAzBzB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBA0ByBR,KAAK,CAACI,OAAN,CAAcM,KAAd,CAAoBC,CAApB,EAAuBN,IAAvB,EA1BzB;;AAAA;AA0BYS,cAAAA,IA1BZ;AA2BMJ,cAAAA,KAAK,CAACG,IAAN,CAAWC,IAAX;;AA3BN;AAyBoCH,cAAAA,CAAC,EAzBrC;AAAA;AAAA;;AAAA;AA6BI7C,cAAAA,UAAU,CAAC2C,CAAD,CAAV;AA7BJ;AAAA;;AAAA;AA+BIxB,cAAAA,MAAM,CAACK,KAAP,CAAa,wDAAb;;AA/BJ;AAkCQyB,cAAAA,sBAlCR,GAkCiC7D,WAAW,CAAC6C,QAAZ,CAAqBF,SAArB,CAlCjC;;AAAA,mBAmCKkB,sBAnCL;AAAA;AAAA;AAAA;;AAoCUf,cAAAA,MApCV,GAoCkB,IAAIb,IAAI,CAACK,GAAL,CAASS,QAAb,CAAsB/C,WAAW,CAACgD,GAAlC,EAAuCa,sBAAsB,CAACZ,OAA9D,CApClB;AAqCIzC,cAAAA,cAAc,CAACsC,MAAD,CAAd;AArCJ;AAAA,qBAsCwBA,MAAK,CAACI,OAAN,CAAcrC,YAAd,GAA6BsC,IAA7B,EAtCxB;;AAAA;AAsCUC,cAAAA,MAtCV;AAuCIU,cAAAA,OAAO,CAACC,GAAR,CAAYX,MAAZ;AACAtC,cAAAA,eAAe,CAACsC,MAAD,CAAf,CAxCJ,CAyCI;;AAEIG,cAAAA,EA3CR,GA2CY,EA3CZ;AA4CQC,cAAAA,MA5CR,GA4CgB,EA5ChB;AA8CaC,cAAAA,CA9Cb,GA8CiB,CA9CjB;;AAAA;AAAA,oBA8CoBA,CAAC,IAAIL,MA9CzB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBA+C2BN,MAAK,CAACI,OAAN,CAAcnC,QAAd,CAAuB0C,CAAvB,EAA0BN,IAA1B,EA/C3B;;AAAA;AA+CYO,cAAAA,OA/CZ;;AAgDMH,cAAAA,EAAC,CAACI,IAAF,CAAOD,OAAP;;AAhDN;AA8CgCD,cAAAA,CAAC,EA9CjC;AAAA;AAAA;;AAAA;AAkDIzC,cAAAA,WAAW,CAACuC,EAAD,CAAX;AAlDJ;AAAA;;AAAA;AAoDIxB,cAAAA,MAAM,CAACK,KAAP,CAAa,wDAAb;;AApDJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAnCuB;AAAA;AAAA;;AAAA,WA4FR4B,eA5FQ;AAAA;AAAA;;AAAA;AAAA,gFA4FvB,kBAA+BC,IAA/B,EAAqCC,KAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AACEJ,cAAAA,OAAO,CAACC,GAAR,CAAY5C,OAAZ;AACC2C,cAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACAxD,cAAAA,WAAW,CAAC2C,OAAZ,CAAoBiB,aAApB,CAAkCF,IAAlC,EAAwCC,KAAxC,EAA+C/C,OAA/C,EAAwDiD,IAAxD,CAA6D;AAAEC,gBAAAA,IAAI,EAAElE,OAAR;AAAiBmE,gBAAAA,KAAK,EAAEJ;AAAxB,eAA7D,EACCK,EADD,CACI,iBADJ,EACuB,UAACC,IAAD,EAAU;AAC/BtD,gBAAAA,MAAM,CAAC,CAAD,CAAN;AACD,eAHD;AAKIuD,cAAAA,mBARP,GAQ6B,IAR7B,EAQmC;;AAEpCC,cAAAA,UAAU,wEAAE;AAAA;AAAA;AAAA;AAAA;AACV;AACArC,wBAAAA,kBAAkB;;AAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAF,IAIPoC,mBAJO,CAAV,CAVC,CAgBG;AACA;AACA;AACA;;AAnBH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA5FuB;AAAA;AAAA;;AAkHtB,WAAWE,SAAX,CAAqBC,EAArB,EAAyBV,KAAzB,EAAgC;AAC9BJ,IAAAA,OAAO,CAACC,GAAR,CAAYG,KAAZ;AACAJ,IAAAA,OAAO,CAACC,GAAR,CAAYa,EAAZ;AACAd,IAAAA,OAAO,CAACC,GAAR,CAAY5C,OAAZ;AACA2C,IAAAA,OAAO,CAACC,GAAR,CAAY5D,OAAZ;AACCI,IAAAA,WAAW,CAAC2C,OAAZ,CAAoB2B,eAApB,CAAoCD,EAApC,EAAwCR,IAAxC,CAA6C;AAAEC,MAAAA,IAAI,EAAElE,OAAR;AAAiBmE,MAAAA,KAAK,EAAEJ,KAAxB;AAA+BY,MAAAA,EAAE,EAAE3D;AAAnC,KAA7C,EACA4D,IADA,CACK,SADL,EACgB,UAACC,OAAD,EAAa,CAClC;AACK,KAHA;AAMD,QAAIP,mBAAmB,GAAG,IAA1B,CAX8B,CAWE;;AAEpCC,IAAAA,UAAU,wEAAE;AAAA;AAAA;AAAA;AAAA;AACV;AACArC,cAAAA,kBAAkB;;AAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF,IAIPoC,mBAJO,CAAV;AAKG;;AACD1C,EAAAA,MAAM,CAACC,QAAP,CAAgBuC,EAAhB,CAAmB,iBAAnB,EAAsC,UAAU/B,QAAV,EAAoB;AACxD;AACAsB,IAAAA,OAAO,CAACC,GAAR,CAAYvB,QAAZ;AACApC,IAAAA,UAAU,CAACoC,QAAQ,CAAC,CAAD,CAAT,CAAV;AACD,GAJD;;AArIsB,WA2IT2B,aA3IS;AAAA;AAAA;;AAAA;AAAA,8EA2IxB,kBAA6BF,IAA7B,EAAmCgB,QAAnC,EAA6CC,IAA7C,EAAmDC,QAAnD,EAA6DjB,KAA7D,EAAoEkB,UAApE,EAAgFC,OAAhF;AAAA;AAAA;AAAA;AAAA;AAAA;AACGhF,cAAAA,UAAU,CAAC6C,OAAX,CAAmBoC,YAAnB,CAAgCrB,IAAhC,EAAsCgB,QAAtC,EAAgDC,IAAhD,EAAsDC,QAAtD,EAAgEjB,KAAhE,EAAuEkB,UAAvE,EAAmFC,OAAnF,EAA4FjB,IAA5F,CAAiG;AAAEC,gBAAAA,IAAI,EAAElE;AAAR,eAAjG;AACIsE,cAAAA,mBAFP,GAE6B,IAF7B,EAEmC;;AACpCC,cAAAA,UAAU,wEAAE;AAAA;AAAA;AAAA;AAAA;AACV;AACArC,wBAAAA,kBAAkB;;AAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAF,IAIPoC,mBAJO,CAAV;;AAHC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA3IwB;AAAA;AAAA;;AAAA,WAuJRc,iBAvJQ;AAAA;AAAA;;AAAA;AAAA,kFAuJvB,kBAAiCC,KAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AACMhC,cAAAA,KADN,GACc,EADd;AAEWC,cAAAA,CAFX,GAEe,CAFf;;AAAA;AAAA,oBAEkBA,CAAC,IAAIpC,aAFvB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAGuBhB,UAAU,CAAC6C,OAAX,CAAmBM,KAAnB,CAAyBC,CAAzB,EAA4BN,IAA5B,EAHvB;;AAAA;AAGUS,cAAAA,IAHV;AAIIA,cAAAA,IAAI,CAAC6B,MAAL,GAAc7B,IAAI,CAAC6B,MAAL,GAAc,oBAA5B;AACApF,cAAAA,UAAU,CAAC6C,OAAX,CAAmBwC,KAAnB,CAAyB9B,IAAI,CAAC+B,QAA9B,EAAwCvB,IAAxC,CAA6C;AAAEC,gBAAAA,IAAI,EAAElE,OAAR;AAAiBmE,gBAAAA,KAAK,EAAEV,IAAI,CAAC6B,MAA7B;AAAqCX,gBAAAA,EAAE,EAAElB,IAAI,CAACgC;AAA9C,eAA7C;AACApC,cAAAA,KAAK,CAACG,IAAN,CAAWC,IAAX;;AANJ;AAEsCH,cAAAA,CAAC,EAFvC;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAvJuB;AAAA;AAAA;;AAiKvB,WAAWoB,eAAX,CAA2BD,EAA3B,EAA+BV,KAA/B,EAAsCuB,MAAtC,EAA8CI,cAA9C,EAA8D;AAC3DxF,IAAAA,UAAU,CAAC6C,OAAX,CAAmB2B,eAAnB,CAAmCD,EAAnC,EAAuCR,IAAvC,CAA4C;AAAEC,MAAAA,IAAI,EAAElE,OAAR;AAAiBmE,MAAAA,KAAK,EAAEJ,KAAxB;AAA+BY,MAAAA,EAAE,EAAE3D;AAAnC,KAA5C;AAEDd,IAAAA,UAAU,CAAC6C,OAAX,CAAmB4C,eAAnB,CAAmClB,EAAnC,EAAsCa,MAAtC,EAA8CI,cAA9C,EAA8DzB,IAA9D,CAAmE;AAAEC,MAAAA,IAAI,EAAElE;AAAR,KAAnE,EACCoE,EADD,CACI,iBADJ,EACuB,UAACC,IAAD,EAAU;AAC/BtD,MAAAA,MAAM,CAAC,CAAD,CAAN;AACD,KAHD;AAII,QAAIuD,mBAAmB,GAAG,IAA1B,CAPwD,CAOxB;;AAExCC,IAAAA,UAAU,wEAAE;AAAA;AAAA;AAAA;AAAA;AACV;AACArC,cAAAA,kBAAkB;;AAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF,IAIPoC,mBAJO,CAAV;AAKG;;AACD1C,EAAAA,MAAM,CAACC,QAAP,CAAgBuC,EAAhB,CAAmB,iBAAnB,EAAsC,UAAU/B,QAAV,EAAoB;AACxD;AACApC,IAAAA,UAAU,CAACoC,QAAQ,CAAC,CAAD,CAAT,CAAV;AACD,GAHD,EAhLuB,CAqLvB;;AACA5C,EAAAA,SAAS,CAAC,YAAM;AACdkC,IAAAA,QAAQ;AACRO,IAAAA,kBAAkB,GAFJ,CAGd;AACD,GAJQ,EAIN,EAJM,CAAT;AAME,sBACE;AAAK,IAAA,EAAE,EAAC,SAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAMlB,OAAN,CADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAFF,eAGE;AAAM,IAAA,QAAQ,EAAE,kBAACqE,KAAD,EAAW;AACzB1B,MAAAA,OAAO,CAACC,GAAR,CAAYtC,OAAZ;AACAqC,MAAAA,OAAO,CAACC,GAAR,CAAYlC,SAAS,CAACkE,OAAV,CAAkBzB,KAA9B;AACAR,MAAAA,OAAO,CAACC,GAAR,CAAYxC,UAAZ;AACAuC,MAAAA,OAAO,CAACC,GAAR,CAAYyB,KAAK,CAACQ,MAAN,CAAazE,UAAzB;AACAiE,MAAAA,KAAK,CAACS,cAAN;AACA,UAAMC,UAAU,GAAGnE,MAAM,CAACE,IAAP,CAAYkE,KAAZ,CAAkBC,KAAlB,CAAwB3E,OAAO,CAAC4E,QAAR,EAAxB,EAA4C,OAA5C,CAAnB;;AACA,MAAA,KAAI,CAACnG,KAAL,CAAW8D,eAAX,CAA2BzC,UAA3B,EAAuC2E,UAAvC,EAAmDvE,IAAnD;AACD,KARD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBASE;AAAK,IAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,EAAE,EAAC,YADL;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,GAAG,EAAEE,SAHP;AAIE,IAAA,SAAS,EAAC,cAJZ;AAKE,IAAA,WAAW,EAAC,YALd;AAME,IAAA,QAAQ,MANV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CATF,eAkBE;AAAK,IAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,EAAE,EAAC,SADL;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,GAAG,EAAE,aAACyE,KAAD,EAAW;AAAE5E,MAAAA,UAAU,CAAC4E,KAAD,CAAV;AAAmB,KAHvC;AAIE,IAAA,SAAS,EAAC,cAJZ;AAKE,IAAA,WAAW,EAAC,SALd;AAME,IAAA,QAAQ,MANV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAlBF,eA2BE;AAAK,IAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,EAAE,EAAC,MADL;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,GAAG,EAAE,aAACA,KAAD,EAAW;AACd1E,MAAAA,OAAO,CAAC0E,KAAD,CAAP;AAAgB,KAJpB;AAKE,IAAA,SAAS,EAAC,cALZ;AAME,IAAA,WAAW,EAAC,MANd;AAOE,IAAA,QAAQ,MAPV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CA3BF,eAqCE;AAAQ,IAAA,IAAI,EAAC,QAAb;AAAsB,IAAA,SAAS,EAAC,iBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BArCF,CAHF,eA0CE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YA1CF,eA2CE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBA3CF,eA4CE;AAAO,IAAA,SAAS,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,KAAK,EAAC,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADF,eAEE;AAAI,IAAA,KAAK,EAAC,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFF,eAGE;AAAI,IAAA,KAAK,EAAC,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAHF,eAIE;AAAI,IAAA,KAAK,EAAC,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAJF,eAKE;AAAI,IAAA,KAAK,EAAC,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,CADF,CADF,eAUE;AAAO,IAAA,EAAE,EAAC,aAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACIvF,QAAQ,CAACwF,GAAT,CAAa,UAACC,OAAD,EAAUC,GAAV,EAAkB;AAC/B3C,IAAAA,OAAO,CAACC,GAAR,CAAYyC,OAAZ;AACA,wBACE;AAAI,MAAA,GAAG,EAAEC,GAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAI,MAAA,KAAK,EAAC,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAiBD,OAAO,CAACE,QAAzB,CADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAKF,OAAO,CAACvC,IAAb,CAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAKuC,OAAO,CAAC7E,IAAb,CAHF,eAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAKI,MAAM,CAACE,IAAP,CAAYkE,KAAZ,CAAkBQ,OAAlB,CAA0BH,OAAO,CAACtC,KAAR,CAAcmC,QAAd,EAA1B,EAAoD,OAApD,CAAL,SAJF,eAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,CAACG,OAAO,CAACI,SAAT,gBACE;AACE,MAAA,IAAI,EAAEJ,OAAO,CAAC5B,EADhB;AAEE,MAAA,KAAK,EAAE4B,OAAO,CAACtC,KAFjB;AAGE,MAAA,OAAO,EAAE,iBAACsB,KAAD,EAAW;AAClB,QAAA,KAAI,CAACtF,KAAL,CAAWyE,SAAX,CAAqBa,KAAK,CAACQ,MAAN,CAAa/B,IAAlC,EAAwCuB,KAAK,CAACQ,MAAN,CAAa1B,KAArD;AACD,OALH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,GAUE,IAXN,CALF,CADF;AAsBD,GAxBC,CADJ,CAVF,CA5CF,CADF;AAsFH;;AAED,eAAerE,OAAf","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport Web3 from 'web3'\r\nimport Investment from './abis/Investment.json'\r\nimport Marketplace from './abis/Marketplace.json'\r\n\r\nfunction Weather (props) {\r\n\r\n  const [account, setAccount] = useState(0);\r\n  const [investment, setInvestment] = useState(null);\r\n  const [marketplace, setMarketplace] = useState(null);\r\n\r\n  const [farmerCount, setFarmerCount] = useState(0);\r\n  const [farmers, setFarmers] = useState([]);\r\n\r\n  const [productCount, setProductCount] = useState(0);\r\n  const [products, setProducts] = useState([]);\r\n\r\n  const [pro, setPro] = useState(0);\r\n  const [initial, setInitial] = useState(0);\r\n  const [investorCount, SetInvestorCount] = useState(0);\r\n\r\n  const [farmerName, setFarmerName] = useState('');\r\n  const [premium, setPremium] = useState(0);\r\n  const [type, setType] = useState('');\r\n\r\n  const textInput = useRef(null);\r\n\r\n\r\n  async function loadWeb3() {\r\n    if (window.ethereum) {\r\n      window.web3 = new Web3(window.ethereum)\r\n      await window.ethereum.enable()\r\n    }\r\n    else if (window.web3) {\r\n      window.web3 = new Web3(window.web3.currentProvider)\r\n    }\r\n    else {\r\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\r\n    }\r\n  }\r\n  async function loadBlockchainData() {\r\n    const web3 = window.web3\r\n    // Load account\r\n    const accounts = await web3.eth.getAccounts()\r\n    setInitial(accounts[0]);\r\n    setAccount(accounts[0]);\r\n    //this.setState({ account: accounts[0] })\r\n    const networkId = await web3.eth.net.getId()\r\n    const networkData = Investment.networks[networkId]\r\n    if(networkData) {\r\n      const place = new web3.eth.Contract(Investment.abi, networkData.address)\r\n      setInvestment(place);\r\n      const count = await place.methods.farmerCount().call()\r\n      setFarmerCount(count);\r\n      // Load products\r\n\r\n      const dealcount = await place.methods.dealCount().call()\r\n      SetInvestorCount(dealcount);\r\n      let p = []\r\n      let deals = [];\r\n      let c;\r\n      for (var i = 1; i <= count; i++) {\r\n        const farmer = await place.methods.farmers(i).call()\r\n        p.push(farmer);\r\n      }\r\n      for (var i = 1; i <= dealcount; i++) {\r\n        const deal = await place.methods.deals(i).call()\r\n        deals.push(deal);\r\n      }\r\n      setFarmers(p);\r\n    } else {\r\n      window.alert('Marketplace contract not deployed to detected network.')\r\n    }\r\n\r\n    const networkDataMarketplace = Marketplace.networks[networkId]\r\n    if(networkDataMarketplace) {\r\n      const place = new web3.eth.Contract(Marketplace.abi, networkDataMarketplace.address)\r\n      setMarketplace(place);\r\n      const count = await place.methods.productCount().call()\r\n      console.log(count);\r\n      setProductCount(count);\r\n      // Load products\r\n\r\n      let p = []\r\n      let deals = [];\r\n      let c;\r\n      for (var i = 1; i <= count; i++) {\r\n        const farmer = await place.methods.products(i).call()\r\n        p.push(farmer);\r\n      }\r\n      setProducts(p);\r\n    } else {\r\n      window.alert('Marketplace contract not deployed to detected network.')\r\n    }\r\n  }\r\n\r\n\r\n  async function createInsurance(name, price) {\r\n    console.log(initial);\r\n     console.log(\"Hhsjdhfskj\");\r\n     marketplace.methods.createProduct(name, price, initial).send({ from: account, value: price })\r\n     .on('transactionHash', (hash) => {\r\n       setPro(1);\r\n     })\r\n \r\n     var delayInMilliseconds = 8000; //1 second\r\n \r\n setTimeout( async function() {\r\n   //your code to be executed after 1 second\r\n   loadBlockchainData();\r\n \r\n }, delayInMilliseconds);\r\n \r\n     // let tx = await marketplace.methods.createProduct(name, price).send({ from: account })\r\n     // tx.wait().then({\r\n     //   loadBlockchainData\r\n     // })\r\n   }\r\n \r\n   function   reimburse(id, price) {\r\n     console.log(price);\r\n     console.log(id);\r\n     console.log(initial);\r\n     console.log(account);\r\n      marketplace.methods.purchaseProduct(id).send({ from: account, value: price, to: initial })\r\n     .once('receipt', (receipt) => {\r\n //      this.setState({ loading: false })\r\n     })\r\n \r\n \r\n     var delayInMilliseconds = 8000; //1 second\r\n \r\n setTimeout( async function() {\r\n   //your code to be executed after 1 second\r\n   loadBlockchainData();\r\n \r\n }, delayInMilliseconds);\r\n   }\r\n   window.ethereum.on('accountsChanged', function (accounts) {\r\n     // Time to reload your interface with accounts[0]!\r\n     console.log(accounts);\r\n     setAccount(accounts[0])\r\n   })\r\n  \r\n async function createProduct(name, location, crop, quantity, price, expiryDate, holding) {\r\n    investment.methods.createFarmer(name, location, crop, quantity, price, expiryDate, holding).send({ from: account })\r\n    var delayInMilliseconds = 8000; //1 second\r\nsetTimeout( async function() {\r\n  //your code to be executed after 1 second\r\n  loadBlockchainData();\r\n\r\n}, delayInMilliseconds);\r\n  }\r\n\r\n\r\n\r\n  async function payBackToInvestor(event){\r\n    let deals = [];\r\n    for (var i = 1; i <= investorCount; i++) {\r\n      const deal = await investment.methods.deals(i).call()\r\n      deal.amount = deal.amount + \"000000000000000000\";\r\n      investment.methods.repay(deal.farmerID).send({ from: account, value: deal.amount, to: deal.investorAddress})\r\n      deals.push(deal);\r\n    }\r\n  }\r\n\r\n  function   purchaseProduct(id, price, amount, holdingPercent) {\r\n     investment.methods.purchaseProduct(id).send({ from: account, value: price, to: initial })\r\n\r\n    investment.methods.createAgreement(id,amount, holdingPercent).send({ from: account })\r\n    .on('transactionHash', (hash) => {\r\n      setPro(1);\r\n    })\r\n        var delayInMilliseconds = 8000; //1 second\r\n\r\nsetTimeout( async function() {\r\n  //your code to be executed after 1 second\r\n  loadBlockchainData();\r\n\r\n}, delayInMilliseconds);\r\n  }\r\n  window.ethereum.on('accountsChanged', function (accounts) {\r\n    // Time to reload your interface with accounts[0]!\r\n    setAccount(accounts[0])\r\n  })\r\n\r\n  // Similar to componentDidMount and componentDidUpdate:\r\n  useEffect(() => {\r\n    loadWeb3();\r\n    loadBlockchainData();\r\n    // Update the document title using the browser API\r\n  }, []);\r\n\r\n    return (\r\n      <div id=\"content\">\r\n        <h3> {initial}</h3>\r\n        <h1>Buy Insurance</h1>\r\n        <form onSubmit={(event) => {\r\n          console.log(premium);\r\n          console.log(textInput.current.value);\r\n          console.log(farmerName);\r\n          console.log(event.target.farmerName);\r\n          event.preventDefault()\r\n          const premiumVal = window.web3.utils.toWei(premium.toString(), 'Ether')\r\n          this.props.createInsurance(farmerName, premiumVal, type)\r\n        }}>\r\n          <div className=\"form-group mr-sm-2\">\r\n            <input\r\n              id=\"farmerName\"\r\n              type=\"text\"\r\n              ref={textInput}\r\n              className=\"form-control\"\r\n              placeholder=\"Famer Name\"\r\n              required />\r\n          </div>\r\n          <div className=\"form-group mr-sm-2\">\r\n            <input\r\n              id=\"premium\"\r\n              type=\"text\"\r\n              ref={(input) => { setPremium(input) }}\r\n              className=\"form-control\"\r\n              placeholder=\"Premium\"\r\n              required />\r\n          </div>\r\n          <div className=\"form-group mr-sm-2\">\r\n            <input\r\n              id=\"type\"\r\n              type=\"text\"\r\n              ref={(input) => { \r\n                setType(input) }}\r\n              className=\"form-control\"\r\n              placeholder=\"type\"\r\n              required />\r\n          </div>\r\n          <button type=\"submit\" className=\"btn btn-primary\">Add Farmer Details</button>\r\n        </form>\r\n        <p>&nbsp;</p>\r\n        <h2>Farmer Payouts</h2>\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th scope=\"col\">#</th>\r\n              <th scope=\"col\">Name</th>\r\n              <th scope=\"col\">Premium</th>\r\n              <th scope=\"col\">Type</th>\r\n              <th scope=\"col\"></th>\r\n            </tr>\r\n          </thead>\r\n          <tbody id=\"productList\">\r\n            { products.map((product, key) => {\r\n              console.log(product);\r\n              return(\r\n                <tr key={key}>\r\n                  <th scope=\"row\">{product.farmerId}</th>\r\n                  <td>{product.name}</td>\r\n                  <td>{product.type}</td>\r\n                  <td>{window.web3.utils.fromWei(product.price.toString(), 'Ether')} Eth</td>\r\n                  <td>\r\n                    { !product.purchased\r\n                      ? <button\r\n                          name={product.id}\r\n                          value={product.price}\r\n                          onClick={(event) => {\r\n                            this.props.reimburse(event.target.name, event.target.value)\r\n                          }}\r\n                        >\r\n                          Reimburse\r\n                        </button>\r\n                      : null\r\n                    }\r\n                    </td>\r\n                </tr>\r\n              )\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  \r\n}\r\n\r\nexport default Weather;\r\n"]},"metadata":{},"sourceType":"module"}